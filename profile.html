<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title class="tr" data-key="profile">ุงูููู ุงูุดุฎุตู | SM</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .profile-card { max-width: 450px; margin: 30px auto; background: var(--card); padding: 30px; border-radius: 20px; box-shadow: 0 10px 20px rgba(0,0,0,0.1); text-align: center; }
        .avatar { width: 90px; height: 90px; background: var(--p); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; margin: 0 auto 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        .data-box { background: var(--bg); padding: 12px; border-radius: 12px; margin-bottom: 12px; text-align: right; border: 1px solid rgba(0,0,0,0.05); }
        .data-box span { display: block; font-size: 0.75rem; opacity: 0.6; font-weight: bold; margin-bottom: 5px; }
        input, select { width: 100%; border: none; background: transparent; font-size: 1rem; color: var(--txt); outline: none; }
        .save-btn { width: 100%; padding: 15px; background: var(--p); color: white; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; margin-top: 10px; transition: 0.3s; }
        .save-btn:hover { opacity: 0.9; transform: translateY(-2px); }
    </style>
</head>
<body class="light-mode">

    <div class="header">
        <button class="icon-btn" onclick="location.href='dashboard.html'">๐</button>
        <h2 class="tr" data-key="profile">ุงูููู ุงูุดุฎุตู</h2>
        <button id="logoutBtn" class="icon-btn">๐ช</button>
    </div>

    <div class="profile-card">
        <div class="avatar" id="uAvatar">?</div>
        <h3 id="uName">ุฌุงุฑู ุงูุชุญููู...</h3>
        <p id="uEmail" style="font-size: 0.85rem; opacity: 0.6; margin-bottom: 25px;"></p>

        <div class="data-box">
            <span>ุงูุงุณู ุงููุงูู</span>
            <input type="text" id="fullnameInput">
        </div>

        <div class="data-box">
            <span>ุฌูุณู</span>
            <select id="userGender">
                <option value="male">ุฐูุฑ</option>
                <option value="female">ุฃูุซู</option>
            </select>
        </div>

        <div class="data-box">
            <span>ุฃุจุญุซ ุนู (ูู ุงูุจุญุซ ุงูุนุดูุงุฆู)</span>
            <select id="seekingGender">
                <option value="male">ุฑุฌุงู ููุท</option>
                <option value="female">ูุณุงุก ููุท</option>
                <option value="both">ุงูุฌููุน (ุนุดูุงุฆู)</option>
            </select>
        </div>

        <div class="data-box">
    <span>ุงุฎุชุฑ ุงูุฏููุฉ</span>
    <select id="userCountry">
        <option value="Afghanistan">ุฃูุบุงูุณุชุงู</option>
        <option value="Albania">ุฃูุจุงููุง</option>
        <option value="Algeria">ุงูุฌุฒุงุฆุฑ</option>
        <option value="Andorra">ุฃูุฏูุฑุง</option>
        <option value="Angola">ุฃูุบููุง</option>
        <option value="Argentina">ุงูุฃุฑุฌูุชูู</option>
        <option value="Armenia">ุฃุฑููููุง</option>
        <option value="Australia">ุฃุณุชุฑุงููุง</option>
        <option value="Austria">ุงูููุณุง</option>
        <option value="Bahrain">ุงูุจุญุฑูู</option>
        <option value="Bangladesh">ุจูุบูุงุฏูุด</option>
        <option value="Belgium">ุจูุฌููุง</option>
        <option value="Brazil">ุงูุจุฑุงุฒูู</option>
        <option value="Canada">ููุฏุง</option>
        <option value="China">ุงูุตูู</option>
        <option value="Colombia">ูููููุจูุง</option>
        <option value="Denmark">ุงูุฏููุงุฑู</option>
        <option value="Egypt">ูุตุฑ</option>
        <option value="France">ูุฑูุณุง</option>
        <option value="Germany">ุฃููุงููุง</option>
        <option value="India">ุงูููุฏ</option>
        <option value="Indonesia">ุฅูุฏูููุณูุง</option>
        <option value="Iran">ุฅูุฑุงู</option>
        <option value="Iraq">ุงูุนุฑุงู</option>
        <option value="Italy">ุฅูุทุงููุง</option>
        <option value="Japan">ุงููุงุจุงู</option>
        <option value="Jordan">ุงูุฃุฑุฏู</option>
        <option value="Kuwait">ุงููููุช</option>
        <option value="Lebanon">ูุจูุงู</option>
        <option value="Libya">ููุจูุง</option>
        <option value="Malaysia">ูุงููุฒูุง</option>
        <option value="Mexico">ุงูููุณูู</option>
        <option value="Morocco">ุงููุบุฑุจ</option>
        <option value="Netherlands">ููููุฏุง</option>
        <option value="New Zealand">ูููุฒูููุฏุง</option>
        <option value="Nigeria">ููุฌูุฑูุง</option>
        <option value="Norway">ุงููุฑููุฌ</option>
        <option value="Oman">ุนููุงู</option>
        <option value="Pakistan">ุจุงูุณุชุงู</option>
        <option value="Palestine">ููุณุทูู</option>
        <option value="Philippines">ุงูููุจูู</option>
        <option value="Poland">ุจูููุฏุง</option>
        <option value="Portugal">ุงูุจุฑุชุบุงู</option>
        <option value="Qatar">ูุทุฑ</option>
        <option value="Russia">ุฑูุณูุง</option>
        <option value="Saudi Arabia">ุงูุณุนูุฏูุฉ</option>
        <option value="South Africa">ุฌููุจ ุฃูุฑูููุง</option>
        <option value="South Korea">ููุฑูุง ุงูุฌููุจูุฉ</option>
        <option value="Spain">ุฅุณุจุงููุง</option>
        <option value="Sudan">ุงูุณูุฏุงู</option>
        <option value="Sweden">ุงูุณููุฏ</option>
        <option value="Switzerland">ุณููุณุฑุง</option>
        <option value="Syria">ุณูุฑูุง</option>
        <option value="Tunisia">ุชููุณ</option>
        <option value="Turkey">ุชุฑููุง</option>
        <option value="UAE">ุงูุฅูุงุฑุงุช</option>
        <option value="UK">ุงูููููุฉ ุงููุชุญุฏุฉ</option>
        <option value="USA">ุงูููุงูุงุช ุงููุชุญุฏุฉ</option>
        <option value="Yemen">ุงูููู</option>
        <option value="Others">ุฏูู ุฃุฎุฑู</option>
    </select>
</div>
        

        <div class="data-box">
    <span>ุงูุงูุชูุงูุงุช ุงูุฑุฆูุณูุฉ</span>
    <select id="userInterest">
        <option value="Sports">ุงูุฑูุงุถุฉ</option>
        <option value="Gaming">ุงูุฃูุนุงุจ</option>
        <option value="Music">ุงูููุณููู</option>
        <option value="Movies">ุงูุฃููุงู ูุงููุณูุณูุงุช</option>
        <option value="Books">ุงููุชุจ ูุงููุฑุงุกุฉ</option>
        <option value="Tech">ุงูุชูููุฉ</option>
        <option value="AI">ุงูุฐูุงุก ุงูุงุตุทูุงุนู</option>
        <option value="Programming">ุงูุจุฑูุฌุฉ</option>
        <option value="Travel">ุงูุณูุฑ</option>
        <option value="Cooking">ุงูุทุจุฎ</option>
        <option value="Fashion">ุงูููุถุฉ ูุงูุฃุฒูุงุก</option>
        <option value="Pets">ุงูุญููุงูุงุช ุงูุฃูููุฉ</option>
        <option value="Photography">ุงูุชุตููุฑ</option>
        <option value="Art">ุงููููู ูุงูุฑุณู</option>
        <option value="Volunteering">ุงูุนูู ุงูุชุทูุนู</option>
        <option value="Fitness">ุงูุตุญุฉ ูุงูููุงูุฉ</option>
        <option value="Chat">ุฏุฑุฏุดุฉ ุนุงูุฉ</option>
        <option value="Business">ุงูุฃุนูุงู ูุงูุชุฌุงุฑุฉ</option>
        <option value="Science">ุงูุนููู</option>
        <option value="History">ุงูุชุงุฑูุฎ</option>
        <option value="Languages">ุชุนูู ุงููุบุงุช</option>
        <option value="Nature">ุงูุทุจูุนุฉ ูุงูุฑุญูุงุช</option>
        <option value="Food">ุงููุฃูููุงุช</option>
        <option value="Others">ุงูุชูุงูุงุช ุฃุฎุฑู</option>
    </select>
</div>


        <button class="save-btn" id="saveProfile">ุญูุธ ุงูุชุบููุฑุงุช โ</button>
    </div>

    <script type="module">
        import { auth, db } from './ui-logic.js';
        import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { doc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        onAuthStateChanged(auth, async (user) => {
            if (!user) return location.href = "login.html";

            const docSnap = await getDoc(doc(db, "users", user.uid));
            if (docSnap.exists()) {
                const u = docSnap.data();
                document.getElementById("uName").innerText = u.fullname;
                document.getElementById("fullnameInput").value = u.fullname;
                document.getElementById("uEmail").innerText = u.email;
                document.getElementById("uAvatar").innerText = u.fullname.charAt(0).toUpperCase();
                
                // ุชุนุจุฆุฉ ุงูุฎูุงุฑุงุช ุงูุญุงููุฉ
                document.getElementById("userGender").value = u.gender || "male";
                document.getElementById("seekingGender").value = u.seeking || "both";
                document.getElementById("userCountry").value = u.country || "";
                document.getElementById("userInterest").value = u.interest || "";
            }
        });

        // ุญูุธ ุงูุชุนุฏููุงุช
        document.getElementById("saveProfile").onclick = async () => {
            const user = auth.currentUser;
            const btn = document.getElementById("saveProfile");
            
            try {
                btn.innerText = "ุฌุงุฑู ุงูุญูุธ...";
                btn.disabled = true;

                await updateDoc(doc(db, "users", user.uid), {
                    fullname: document.getElementById("fullnameInput").value,
                    gender: document.getElementById("userGender").value,
                    seeking: document.getElementById("seekingGender").value,
                    country: document.getElementById("userCountry").value,
                    interest: document.getElementById("userInterest").value
                });

                btn.innerText = "ุชู ุงูุญูุธ ุจูุฌุงุญ! โจ";
                setTimeout(() => {
                    btn.innerText = "ุญูุธ ุงูุชุบููุฑุงุช โ";
                    btn.disabled = false;
                }, 2000);
            } catch (error) {
                alert("ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุญูุธ");
                btn.disabled = false;
            }
        };

        document.getElementById("logoutBtn").onclick = () => signOut(auth).then(() => location.href="login.html");
    </script>
</body>
</html>

