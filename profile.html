<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title class="tr" data-key="profile">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ | SM</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .profile-card { max-width: 450px; margin: 30px auto; background: var(--card); padding: 30px; border-radius: 20px; box-shadow: 0 10px 20px rgba(0,0,0,0.1); text-align: center; }
        .avatar { width: 90px; height: 90px; background: var(--p); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; margin: 0 auto 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        .data-box { background: var(--bg); padding: 12px; border-radius: 12px; margin-bottom: 12px; text-align: right; border: 1px solid rgba(0,0,0,0.05); }
        .data-box span { display: block; font-size: 0.75rem; opacity: 0.6; font-weight: bold; }
        .data-box strong { font-size: 1.05rem; color: var(--txt); }
    </style>
</head>
<body class="light-mode">

    <div class="header">
        <button class="icon-btn" onclick="location.href='dashboard.html'">ğŸ”™</button>
        <span class="tr" data-key="profile">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</span>
        <button onclick="toggleLang()" id="langBtn" style="width: 35px; height: 35px; border-radius: 50%; font-size: 0.7rem; background: rgba(255,255,255,0.2); color: white; border: none;">EN</button>
    </div>

    <div class="container">
        <div class="profile-card">
            <div id="uAvatar" class="avatar">?</div>
            <h2 id="uName" style="margin-bottom: 25px;">...</h2>

            <div class="data-box">
                <span class="tr" data-key="age">Ø§Ù„Ø¹Ù…Ø±</span>
                <strong id="dispAge">...</strong>
            </div>

            <div class="data-box">
                <span class="tr" data-key="country">Ø§Ù„Ø¯ÙˆÙ„Ø©</span>
                <strong id="dispCountry">...</strong>
            </div>

            <div class="data-box">
                <span class="tr" data-key="interests">Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª</span>
                <strong id="dispInterest">...</strong>
            </div>

            <div style="margin-top: 30px; display: flex; flex-direction: column; gap: 10px;">
                <button onclick="toggleTheme()" class="tr" data-key="theme" style="background: #555;">ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¸Ù‡Ø± ğŸŒ“</button>
                <button id="logoutBtn" class="tr" data-key="logout" style="background: #ff4d4d;">Ø®Ø±ÙˆØ¬</button>
            </div>
        </div>
    </div>

    <script src="ui-logic.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = { 
            apiKey: "AIzaSyAMA4owgSvA_sBh2syHOnRTS5fhnW1JIeg", 
            authDomain: "strangermeeting-91226.firebaseapp.com", 
            projectId: "strangermeeting-91226", 
            storageBucket: "strangermeeting-91226.firebasestorage.app", 
            messagingSenderId: "575547116212", 
            appId: "1:575547116212:web:333a4732abf59903e7e5e1" 
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        onAuthStateChanged(auth, async (user) => {
            if (!user) return location.href = "login.html";

            const docSnap = await getDoc(doc(db, "users", user.uid));
            if (docSnap.exists()) {
                const u = docSnap.data();
                const lang = localStorage.getItem('sm-lang') || 'ar';

                document.getElementById("uName").innerText = u.fullname;
                document.getElementById("dispAge").innerText = u.age;
                document.getElementById("uAvatar").innerText = u.fullname.charAt(0).toUpperCase();
                
                // ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¨Ù„Ø¯ ÙˆØ§Ù„Ø§Ù‡ØªÙ…Ø§Ù… Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù‚Ø§Ù…ÙˆØ³ ÙÙŠ ui-logic.js
                document.getElementById("dispCountry").innerText = i18n[lang][u.country] || u.country;
                document.getElementById("dispInterest").innerText = i18n[lang][u.interest] || u.interest;
            }
        });

        document.getElementById("logoutBtn").onclick = () => {
            signOut(auth).then(() => location.href = "index.html");
        };
    </script>
</body>
</html>
