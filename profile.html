<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title class="tr" data-key="profile">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ | SM</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body { background-color: var(--bg); color: var(--txt); padding-bottom: 60px; }
        .profile-container { max-width: 500px; margin: 0 auto; padding: 20px; }
        
        .profile-card {
            background: var(--card); border-radius: 25px; padding: 30px;
            text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            position: relative; animation: fadeIn 0.5s ease;
        }

        .avatar-wrapper { position: relative; width: 100px; margin: 0 auto 15px; }
        .avatar {
            width: 100px; height: 100px; background: linear-gradient(135deg, var(--p), #128c7e);
            color: white; border-radius: 50%; display: flex; align-items: center;
            justify-content: center; font-size: 2.5rem; font-weight: bold;
            box-shadow: 0 5px 15px rgba(7, 94, 84, 0.3);
        }
        .edit-badge {
            position: absolute; bottom: 0; right: 0; background: var(--accent);
            width: 30px; height: 30px; border-radius: 50%; display: flex;
            align-items: center; justify-content: center; font-size: 0.8rem;
            border: 3px solid var(--card); color: white;
        }

        .data-box { text-align: right; margin-bottom: 20px; }
        .data-box span { display: block; font-size: 0.85rem; font-weight: bold; margin-bottom: 8px; opacity: 0.8; }

        .data-box input, .data-box select {
            width: 100%; padding: 12px 15px; border-radius: 12px;
            border: 1px solid rgba(0,0,0,0.1); background: var(--bg);
            color: var(--txt); outline: none; box-sizing: border-box; font-size: 1rem;
            transition: 0.3s;
        }

        .checkbox-group {
            display: grid; grid-template-columns: 1fr 1fr; gap: 10px;
            background: var(--bg); padding: 15px; border-radius: 12px;
            max-height: 220px; overflow-y: auto; border: 1px solid rgba(0,0,0,0.05);
        }

        .checkbox-group label {
            display: flex; align-items: center; gap: 10px; font-size: 0.85rem;
            cursor: pointer; padding: 8px; background: var(--card);
            border-radius: 8px; transition: 0.2s;
        }
        .checkbox-group label:hover { background: rgba(37, 211, 102, 0.1); }

        .save-btn {
            width: 100%; padding: 16px; border-radius: 50px;
            background: var(--p); color: white; border: none;
            font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 10px;
        }
        
        /* Ø²Ø± Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨ */
        .delete-section {
            margin-top: 30px; padding-top: 20px;
            border-top: 1px dashed rgba(255, 0, 0, 0.2);
        }
        .delete-btn {
            background: none; color: #ff3b30; border: 1px solid #ff3b30;
            padding: 12px; border-radius: 12px; width: 100%;
            cursor: pointer; font-weight: bold; transition: 0.3s;
        }
        .delete-btn:hover { background: #ff3b30; color: white; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="light-mode">

    <div class="header">
        <button class="icon-btn" onclick="location.href='dashboard.html'">ğŸ”™</button>
        <h2 class="tr" data-key="profile">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</h2>
        <button id="logoutBtn" class="icon-btn">ğŸšª</button>
    </div>

    <div class="profile-container">
        <div class="profile-card">
            <div class="avatar-wrapper">
                <div class="avatar" id="uAvatar">?</div>
                <div class="edit-badge">âœï¸</div>
            </div>
            <h3 id="uName">...</h3>
            <p id="uEmail" style="font-size: 0.85rem; opacity: 0.6; margin-bottom: 25px;"></p>

            <div class="data-box">
                <span class="tr" data-key="fullname">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</span>
                <input type="text" id="fullnameInput" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„Ø¸Ø§Ù‡Ø± Ù„Ù„Ø£Ø®Ø±ÙŠÙ†">
            </div>

            <div class="data-box">
                <span class="tr" data-key="gender">Ø§Ù„Ø¬Ù†Ø³</span>
                <select id="userGender">
                    <option value="male" class="tr" data-key="male">Ø°ÙƒØ±</option>
                    <option value="female" class="tr" data-key="female">Ø£Ù†Ø«Ù‰</option>
                </select>
            </div>

            <div class="data-box">
                <span class="tr" data-key="seeking">Ø£Ø±ØºØ¨ ÙÙŠ Ù…Ù‚Ø§Ø¨Ù„Ø©</span>
                <select id="seekingGender">
                    <option value="male" class="tr" data-key="seeking_male">Ø±Ø¬Ø§Ù„</option>
                    <option value="female" class="tr" data-key="seeking_female">Ù†Ø³Ø§Ø¡</option>
                    <option value="both" class="tr" data-key="seeking_both">Ø§Ù„Ø¬Ù…ÙŠØ¹</option>
                </select>
            </div>

            <div class="data-box">
                <span class="tr" data-key="country">Ø§Ù„Ø¯ÙˆÙ„Ø©</span>
                <select id="userCountry">
                    <option value="" class="tr" data-key="select_country">Ø§Ø®ØªØ± Ø¯ÙˆÙ„ØªÙƒ...</option>
                </select>
            </div>

            <div class="data-box">
                <span class="tr" data-key="interests">Ø§Ù„Ù‡ÙˆØ§ÙŠØ§Øª ÙˆØ§Ù„Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª (Ø§Ø®ØªÙŠØ§Ø± Ù…ØªØ¹Ø¯Ø¯)</span>
                <div class="checkbox-group" id="interestsContainer"></div>
            </div>

            <button class="save-btn tr" id="saveProfile" data-key="save_changes">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª âœ…</button>

            <div class="delete-section">
                <button id="deleteAccBtn" class="delete-btn tr" data-key="delete_account">Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ âš ï¸</button>
            </div>
        </div>
    </div>

    <script type="module">
        import { auth, db, applyTranslations, deleteAccount } from './ui-logic.js';
        import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { doc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯ÙˆÙ„ ÙˆØ§Ù„Ù‡ÙˆØ§ÙŠØ§Øª (Ø¨Ù‚ÙŠØª ÙƒÙ…Ø§ Ù‡ÙŠ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª)
        const countriesList = ["Ø£ÙØºØ§Ù†Ø³ØªØ§Ù†", "Ø£Ù„Ø¨Ø§Ù†ÙŠØ§", "Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±", "Ø£Ù†Ø¯ÙˆØ±Ø§", "Ø£Ù†ØºÙˆÙ„Ø§", "Ø£Ù†ØªÙŠØºÙˆØ§ ÙˆØ¨Ø±Ø¨ÙˆØ¯Ø§", "Ø§Ù„Ø£Ø±Ø¬Ù†ØªÙŠÙ†", "Ø£Ø±Ù…ÙŠÙ†ÙŠØ§", "Ø£Ø³ØªØ±Ø§Ù„ÙŠØ§", "Ø§Ù„Ù†Ù…Ø³Ø§", "Ø£Ø°Ø±Ø¨ÙŠØ¬Ø§Ù†", "Ø§Ù„Ø¨Ø§Ù‡Ø§Ù…Ø§", "Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†", "Ø¨Ù†ØºÙ„Ø§Ø¯ÙŠØ´", "Ø¨Ø§Ø±Ø¨Ø§Ø¯ÙˆØ³", "Ø¨ÙŠÙ„Ø§Ø±ÙˆØ³ÙŠØ§", "Ø¨Ù„Ø¬ÙŠÙƒØ§", "Ø¨Ù„ÙŠØ²", "Ø¨Ù†ÙŠÙ†", "Ø¨ÙˆØªØ§Ù†", "Ø¨ÙˆÙ„ÙŠÙÙŠØ§", "Ø§Ù„Ø¨ÙˆØ³Ù†Ø© ÙˆØ§Ù„Ù‡Ø±Ø³Ùƒ", "Ø¨ÙˆØªØ³ÙˆØ§Ù†Ø§", "Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„", "Ø¨Ø±ÙˆÙ†Ø§ÙŠ", "Ø¨Ù„ØºØ§Ø±ÙŠØ§", "Ø¨ÙˆØ±ÙƒÙŠÙ†Ø§ ÙØ§Ø³Ùˆ", "Ø¨ÙˆØ±ÙˆÙ†Ø¯ÙŠ", "ÙƒÙ…Ø¨ÙˆØ¯ÙŠØ§", "Ø§Ù„ÙƒØ§Ù…ÙŠØ±ÙˆÙ†", "ÙƒÙ†Ø¯Ø§", "Ø§Ù„Ø±Ø£Ø³ Ø§Ù„Ø£Ø®Ø¶Ø±", "Ø¬Ù…Ù‡ÙˆØ±ÙŠØ© Ø£ÙØ±ÙŠÙ‚ÙŠØ§ Ø§Ù„ÙˆØ³Ø·Ù‰", "ØªØ´Ø§Ø¯", "ØªØ´ÙŠÙ„ÙŠ", "Ø§Ù„ØµÙŠÙ†", "ÙƒÙˆÙ„ÙˆÙ…Ø¨ÙŠØ§", "Ø¬Ø²Ø± Ø§Ù„Ù‚Ù…Ø±", "Ø§Ù„ÙƒÙˆÙ†ØºÙˆ", "ÙƒÙˆØ³ØªØ§Ø±ÙŠÙƒØ§", "ÙƒØ±ÙˆØ§ØªÙŠØ§", "ÙƒÙˆØ¨Ø§", "Ù‚Ø¨Ø±Øµ", "Ø§Ù„ØªØ´ÙŠÙƒ", "Ø§Ù„Ø¯Ù†Ù…Ø§Ø±Ùƒ", "Ø¬ÙŠØ¨ÙˆØªÙŠ", "Ø¯ÙˆÙ…ÙŠÙ†ÙŠÙƒØ§", "Ø¬Ù…Ù‡ÙˆØ±ÙŠØ© Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†ÙŠÙƒØ§Ù†", "Ø§Ù„Ø¥ÙƒÙˆØ§Ø¯ÙˆØ±", "Ù…ØµØ±", "Ø§Ù„Ø³Ù„ÙØ§Ø¯ÙˆØ±", "ØºÙŠÙ†ÙŠØ§ Ø§Ù„Ø§Ø³ØªÙˆØ§Ø¦ÙŠØ©", "Ø¥Ø±ÙŠØªØ±ÙŠØ§", "Ø¥Ø³ØªÙˆÙ†ÙŠØ§", "Ø¥Ø³ÙˆØ§ØªÙŠÙ†ÙŠ", "Ø¥Ø«ÙŠÙˆØ¨ÙŠØ§", "ÙÙŠØ¬ÙŠ", "ÙÙ†Ù„Ù†Ø¯Ø§", "ÙØ±Ù†Ø³Ø§", "Ø§Ù„ØºØ§Ø¨ÙˆÙ†", "ØºØ§Ù…Ø¨ÙŠØ§", "Ø¬ÙˆØ±Ø¬ÙŠØ§", "Ø£Ù„Ù…Ø§Ù†ÙŠØ§", "ØºØ§Ù†Ø§", "Ø§Ù„ÙŠÙˆÙ†Ø§Ù†", "ØºØ±ÙŠÙ†Ø§Ø¯Ø§", "ØºÙˆØ§ØªÙŠÙ…Ø§Ù„Ø§", "ØºÙŠÙ†ÙŠØ§", "ØºÙŠÙ†ÙŠØ§ Ø¨ÙŠØ³Ø§Ùˆ", "ØºÙŠØ§Ù†Ø§", "Ù‡Ø§ÙŠØªÙŠ", "Ù‡Ù†Ø¯ÙˆØ±Ø§Ø³", "Ø§Ù„Ù…Ø¬Ø±", "Ø¢ÙŠØ³Ù„Ù†Ø¯Ø§", "Ø§Ù„Ù‡Ù†Ø¯", "Ø¥Ù†Ø¯ÙˆÙ†ÙŠØ³ÙŠØ§", "Ø¥ÙŠØ±Ø§Ù†", "Ø§Ù„Ø¹Ø±Ø§Ù‚", "Ø£ÙŠØ±Ù„Ù†Ø¯Ø§", "Ø¥ÙŠØ·Ø§Ù„ÙŠØ§", "Ø³Ø§Ø­Ù„ Ø§Ù„Ø¹Ø§Ø¬", "Ø¬Ø§Ù…Ø§ÙŠÙƒØ§", "Ø§Ù„ÙŠØ§Ø¨Ø§Ù†", "Ø§Ù„Ø£Ø±Ø¯Ù†", "ÙƒØ§Ø²Ø§Ø®Ø³ØªØ§Ù†", "ÙƒÙŠÙ†ÙŠØ§", "ÙƒÙŠØ±ÙŠØ¨Ø§ØªÙŠ", "ÙƒÙˆØ±ÙŠØ§ Ø§Ù„Ø´Ù…Ø§Ù„ÙŠØ©", "ÙƒÙˆØ±ÙŠØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©", "Ø§Ù„ÙƒÙˆÙŠØª", "Ù‚ÙŠØ±ØºÙŠØ²Ø³ØªØ§Ù†", "Ù„Ø§ÙˆØ³", "Ù„Ø§ØªÙÙŠØ§", "Ù„Ø¨Ù†Ø§Ù†", "Ù„ÙŠØ³ÙˆØªÙˆ", "Ù„ÙŠØ¨ÙŠØ±ÙŠØ§", "Ù„ÙŠØ¨ÙŠØ§", "Ù„ÙŠØ®ØªÙ†Ø´ØªØ§ÙŠÙ†", "Ù„ÙŠØªÙˆØ§Ù†ÙŠØ§", "Ù„ÙˆÙƒØ³Ù…Ø¨ÙˆØ±Øº", "Ù…Ø¯ØºØ´Ù‚Ø±", "Ù…Ø§Ù„Ø§ÙˆÙŠ", "Ù…Ø§Ù„ÙŠØ²ÙŠØ§", "Ø¬Ø²Ø± Ø§Ù„Ù…Ø§Ù„Ø¯ÙŠÙ", "Ù…Ø§Ù„ÙŠ", "Ù…Ø§Ù„Ø·Ø§", "Ø¬Ø²Ø± Ù…Ø§Ø±Ø´Ø§Ù„", "Ù…ÙˆØ±ÙŠØªØ§Ù†ÙŠØ§", "Ù…ÙˆØ±ÙŠØ´ÙŠÙˆØ³", "Ø§Ù„Ù…ÙƒØ³ÙŠÙƒ", "Ù…ÙŠÙƒØ±ÙˆÙ†ÙŠØ²ÙŠØ§", "Ù…ÙˆÙ„Ø¯ÙˆÙØ§", "Ù…ÙˆÙ†Ø§ÙƒÙˆ", "Ù…Ù†ØºÙˆÙ„ÙŠØ§", "Ø§Ù„Ø¬Ø¨Ù„ Ø§Ù„Ø£Ø³ÙˆØ¯", "Ø§Ù„Ù…ØºØ±Ø¨", "Ù…ÙˆØ²Ù…Ø¨ÙŠÙ‚", "Ù…ÙŠØ§Ù†Ù…Ø§Ø±", "Ù†Ø§Ù…ÙŠØ¨ÙŠØ§", "Ù†Ø§ÙˆØ±Ùˆ", "Ù†ÙŠØ¨Ø§Ù„", "Ù‡ÙˆÙ„Ù†Ø¯Ø§", "Ù†ÙŠÙˆØ²ÙŠÙ„Ù†Ø¯Ø§", "Ù†ÙŠÙƒØ§Ø±Ø§ØºÙˆØ§", "Ø§Ù„Ù†ÙŠØ¬Ø±", "Ù†ÙŠØ¬ÙŠØ±ÙŠØ§", "Ù…Ù‚Ø¯ÙˆÙ†ÙŠØ§ Ø§Ù„Ø´Ù…Ø§Ù„ÙŠØ©", "Ø§Ù„Ù†Ø±ÙˆÙŠØ¬", "Ø¹Ù…Ø§Ù†", "Ø¨Ø§ÙƒØ³ØªØ§Ù†", "Ø¨Ø§Ù„Ø§Ùˆ", "ÙÙ„Ø³Ø·ÙŠÙ†", "Ø¨Ù†Ù…Ø§", "Ø¨Ø§Ø¨ÙˆØ§ ØºÙŠÙ†ÙŠØ§ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©", "Ø¨Ø§Ø±Ø§ØºÙˆØ§ÙŠ", "Ø¨ÙŠØ±Ùˆ", "Ø§Ù„ÙÙ„Ø¨ÙŠÙ†", "Ø¨ÙˆÙ„Ù†Ø¯Ø§", "Ø§Ù„Ø¨Ø±ØªØºØ§Ù„", "Ù‚Ø·Ø±", "Ø±ÙˆÙ…Ø§Ù†ÙŠØ§", "Ø±ÙˆØ³ÙŠØ§", "Ø±ÙˆØ§Ù†Ø¯Ø§", "Ø³Ø§Ù†Øª ÙƒÙŠØªØ³ ÙˆÙ†ÙŠÙÙŠØ³", "Ø³Ø§Ù†Øª Ù„ÙˆØ³ÙŠØ§", "Ø³Ø§Ù†Øª ÙÙ†Ø³Ù†Øª ÙˆØ§Ù„ØºØ±ÙŠÙ†Ø§Ø¯ÙŠÙ†", "Ø³Ø§Ù…ÙˆØ§", "Ø³Ø§Ù† Ù…Ø§Ø±ÙŠÙ†Ùˆ", "Ø³Ø§Ùˆ ØªÙˆÙ…ÙŠ ÙˆØ¨Ø±ÙŠÙ†Ø³ÙŠØ¨", "Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©", "Ø§Ù„Ø³Ù†ØºØ§Ù„", "ØµØ±Ø¨ÙŠØ§", "Ø³ÙŠØ´ÙŠÙ„", "Ø³ÙŠØ±Ø§Ù„ÙŠÙˆÙ†", "Ø³Ù†ØºØ§ÙÙˆØ±Ø©", "Ø³Ù„ÙˆÙØ§ÙƒÙŠØ§", "Ø³Ù„ÙˆÙÙŠÙ†ÙŠØ§", "Ø¬Ø²Ø± Ø³Ù„ÙŠÙ…Ø§Ù†", "Ø§Ù„ØµÙˆÙ…Ø§Ù„", "Ø¬Ù†ÙˆØ¨ Ø£ÙØ±ÙŠÙ‚ÙŠØ§", "Ø¬Ù†ÙˆØ¨ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†", "Ø¥Ø³Ø¨Ø§Ù†ÙŠØ§", "Ø³Ø±ÙŠÙ„Ø§Ù†ÙƒØ§", "Ø§Ù„Ø³ÙˆØ¯Ø§Ù†", "Ø³ÙˆØ±ÙŠÙ†Ø§Ù…", "Ø§Ù„Ø³ÙˆÙŠØ¯", "Ø³ÙˆÙŠØ³Ø±Ø§", "Ø³ÙˆØ±ÙŠØ§", "ØªØ§ÙŠÙˆØ§Ù†", "Ø·Ø§Ø¬ÙŠÙƒØ³ØªØ§Ù†", "ØªÙ†Ø²Ø§Ù†ÙŠØ§", "ØªØ§ÙŠÙ„Ø§Ù†Ø¯", "ØªÙŠÙ…ÙˆØ± Ø§Ù„Ø´Ø±Ù‚ÙŠØ©", "ØªÙˆØºÙˆ", "ØªÙˆÙ†ØºØ§", "ØªØ±ÙŠÙ†ÙŠØ¯Ø§Ø¯ ÙˆØªÙˆØ¨Ø§ØºÙˆ", "ØªÙˆÙ†Ø³", "ØªØ±ÙƒÙŠØ§", "ØªØ±ÙƒÙ…Ø§Ù†Ø³ØªØ§Ù†", "ØªÙˆÙØ§Ù„Ùˆ", "Ø£ÙˆØºÙ†Ø¯Ø§", "Ø£ÙˆÙƒØ±Ø§Ù†ÙŠØ§", "Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª", "Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ù…ØªØ­Ø¯Ø©", "Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø¯Ø©", "Ø£ÙˆØ±ÙˆØºÙˆØ§ÙŠ", "Ø£ÙˆØ²Ø¨ÙƒØ³ØªØ§Ù†", "ÙØ§Ù†ÙˆØ§ØªÙˆ", "ÙÙ†Ø²ÙˆÙŠÙ„Ø§", "ÙÙŠØªÙ†Ø§Ù…", "Ø§Ù„ÙŠÙ…Ù†", "Ø²Ø§Ù…Ø¨ÙŠØ§", "Ø²ÙŠÙ…Ø¨Ø§Ø¨ÙˆÙŠ"];
        
        const hobbiesList = [
            { id: "Sports", ar: "Ø§Ù„Ø±ÙŠØ§Ø¶Ø©", en: "Sports" }, { id: "Gaming", ar: "Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨", en: "Gaming" }, { id: "Music", ar: "Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰", en: "Music" }, { id: "Travel", ar: "Ø§Ù„Ø³ÙØ±", en: "Travel" }, { id: "Tech", ar: "Ø§Ù„ØªÙ‚Ù†ÙŠØ©", en: "Technology" }, { id: "Art", ar: "Ø§Ù„ÙÙ†", en: "Art" }, { id: "Cooking", ar: "Ø§Ù„Ø·Ø¨Ø®", en: "Cooking" }, { id: "Reading", ar: "Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©", en: "Reading" }, { id: "Photography", ar: "Ø§Ù„ØªØµÙˆÙŠØ±", en: "Photography" }, { id: "Writing", ar: "Ø§Ù„ÙƒØªØ§Ø¨Ø©", en: "Writing" }, { id: "Dance", ar: "Ø§Ù„Ø±Ù‚Øµ", en: "Dance" }, { id: "Fitness", ar: "Ø§Ù„Ù„ÙŠØ§Ù‚Ø© Ø§Ù„Ø¨Ø¯Ù†ÙŠØ©", en: "Fitness" }, { id: "Fishing", ar: "Ø§Ù„ØµÙŠØ¯", en: "Fishing" }, { id: "Hiking", ar: "Ø§Ù„Ù…Ø´ÙŠ", en: "Hiking" }, { id: "Camping", ar: "Ø§Ù„ØªØ®ÙŠÙŠÙ…", en: "Camping" }, { id: "Gardening", ar: "Ø§Ù„Ø¨Ø³ØªÙ†Ø©", en: "Gardening" }, { id: "Crafts", ar: "Ø£Ø¹Ù…Ø§Ù„ ÙŠØ¯ÙˆÙŠ", en: "Crafts" }, { id: "Movies", ar: "Ø§Ù„Ø£ÙÙ„Ø§Ù…", en: "Movies" }, { id: "Volunteering", ar: "Ø§Ù„ØªØ·ÙˆØ¹", en: "Volunteering" }, { id: "Meditation", ar: "Ø§Ù„ØªØ£Ù…Ù„", en: "Meditation" }, { id: "Languages", ar: "Ø§Ù„Ù„ØºØ§Øª", en: "Languages" }, { id: "Fashion", ar: "Ø§Ù„Ø£Ø²ÙŠØ§Ø¡", en: "Fashion" }, { id: "Chess", ar: "Ø§Ù„Ø´Ø·Ø±Ù†Ø¬", en: "Chess" }, { id: "Swimming", ar: "Ø§Ù„Ø³Ø¨Ø§Ø­Ø©", en: "Swimming" }
        ];

        function initFields() {
            const countrySelect = document.getElementById("userCountry");
            const hobbyContainer = document.getElementById("interestsContainer");
            const lang = localStorage.getItem('preferredLang') || 'ar';

            countriesList.sort().forEach(c => {
                const opt = document.createElement("option");
                opt.value = c; opt.textContent = c;
                countrySelect.appendChild(opt);
            });

            hobbiesList.forEach(h => {
                const label = document.createElement("label");
                label.innerHTML = `<input type="checkbox" name="interest" value="${h.id}"><span>${lang === 'ar' ? h.ar : h.en}</span>`;
                hobbyContainer.appendChild(label);
            });
        }

        initFields();
        applyTranslations(localStorage.getItem('preferredLang') || 'ar');

        onAuthStateChanged(auth, async (user) => {
            if (!user) return location.href = "login.html";

            const docSnap = await getDoc(doc(db, "users", user.uid));
            if (docSnap.exists()) {
                const u = docSnap.data();
                document.getElementById("uName").innerText = u.fullname || "User";
                document.getElementById("uEmail").innerText = u.email;
                document.getElementById("uAvatar").innerText = (u.fullname || "U").charAt(0).toUpperCase();
                document.getElementById("fullnameInput").value = u.fullname || "";
                document.getElementById("userGender").value = u.gender || "male";
                document.getElementById("seekingGender").value = u.seeking || "both";
                document.getElementById("userCountry").value = u.country || "";

                if (u.interests) {
                    const checkboxes = document.querySelectorAll('input[name="interest"]');
                    checkboxes.forEach(cb => cb.checked = u.interests.includes(cb.value));
                }
            }
        });

        document.getElementById("saveProfile").onclick = async () => {
            const user = auth.currentUser;
            const btn = document.getElementById("saveProfile");
            const selectedInterests = Array.from(document.querySelectorAll('input[name="interest"]:checked')).map(cb => cb.value);

            btn.disabled = true;
            btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...";

            try {
                await updateDoc(doc(db, "users", user.uid), {
                    fullname: document.getElementById("fullnameInput").value,
                    gender: document.getElementById("userGender").value,
                    seeking: document.getElementById("seekingGender").value,
                    country: document.getElementById("userCountry").value,
                    interests: selectedInterests
                });
                
                btn.style.background = "#25d366";
                btn.innerText = "ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­! âœ¨";
                setTimeout(() => {
                    btn.disabled = false;
                    btn.style.background = "var(--p)";
                    btn.innerText = "Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª âœ…";
                }, 2000);
            } catch (e) {
                alert("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­ÙØ¸");
                btn.disabled = false;
            }
        };

        // Ø±Ø¨Ø· Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø®Ø±ÙˆØ¬ ÙˆØ§Ù„Ø­Ø°Ù
        document.getElementById("logoutBtn").onclick = () => signOut(auth).then(() => location.href="login.html");
        document.getElementById("deleteAccBtn").onclick = () => deleteAccount();
    </script>
</body>
</html>

