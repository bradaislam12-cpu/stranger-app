<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù…ÙƒØ§Ù„Ù…Ø© ÙÙŠØ¯ÙŠÙˆ | SM</title>
    <script src="https://meet.jit.si/external_api.js"></script>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; background: #000; overflow: hidden; font-family: sans-serif; }
        #video-container { width: 100%; height: 100%; }
        .overlay-bar { position: fixed; top: 0; width: 100%; padding: 10px; z-index: 1000; background: rgba(0,0,0,0.6); color: white; text-align: center; font-size: 14px; }
        .exit-btn { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); z-index: 1000; background: #ff4757; color: white; padding: 12px 30px; border-radius: 30px; text-decoration: none; font-weight: bold; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <div class="overlay-bar" id="status">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±...</div>
    <button class="exit-btn" onclick="location.href='./dashboard.html'">Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø© âŒ</button>
    <div id="video-container"></div>

    <script>
        const params = new URLSearchParams(window.location.search);
        const roomID = params.get('room') || "GlobalRoom";
        const mode = params.get('mode') || "friend";
        
        document.getElementById("status").innerText = mode === 'stranger' ? "ğŸ•µï¸ Ù…Ø­Ø§Ø¯Ø«Ø© ØºØ±ÙŠØ¨ Ø¢Ù…Ù†Ø©" : "ğŸ”’ Ù…ÙƒØ§Ù„Ù…Ø© ØµØ¯ÙŠÙ‚";

        const domain = "meet.jit.si";
        const options = {
            roomName: "StrangerMeeting-" + roomID,
            width: "100%",
            height: "100%",
            parentNode: document.querySelector('#video-container'),
            // Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø£Ø¯Ù†Ø§Ù‡ Ù‡ÙŠ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„Ø© Ø¹Ù† Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
            configOverwrite: { 
                prejoinPageEnabled: false,    // ØªØ¹Ø·ÙŠÙ„ Ø´Ø§Ø´Ø© "Ø§Ù†Ø¶Ù… Ù„Ù„Ù…Ù„ØªÙ‚Ù‰" (Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ)
                disableDeepLinking: true, 
                startWithAudioMuted: false,   // ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª ÙÙˆØ±Ø§Ù‹
                startWithVideoMuted: false    // ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ÙÙˆØ±Ø§Ù‹
            },
            interfaceConfigOverwrite: {
                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ø²Ø±Ø§Ø± ØºÙŠØ± Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠØ© Ù„ØªØ¨Ø³ÙŠØ· Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
                TOOLBAR_BUTTONS: ['microphone', 'camera', 'hangup', 'tileview', 'chat'],
                SETTINGS_SECTIONS: ['devices', 'language', 'profile'],
                VIDEO_LAYOUT_FIT: 'both'
            }
        };

        const api = new JitsiMeetExternalAPI(domain, options);

        // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ±Ù‰ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ÙÙˆØ± Ø§Ù†Ø¶Ù…Ø§Ù…Ù‡
        api.addEventListener('videoConferenceJoined', () => {
            document.getElementById("status").style.display = 'none';
        });
    </script>
</body>
</html>
