<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title class="tr" data-key="title">Ø§Ù„Ø§Ø³ØªÙƒØ´Ø§Ù | Stranger Meeting</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„Ø­Ø¯ÙŠØ«Ø© */
        .discovery-container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .main-card {
            background: linear-gradient(135deg, var(--p), var(--p-dark));
            border-radius: 20px;
            padding: 40px 20px;
            text-align: center;
            color: white;
            box-shadow: 0 10px 25px rgba(7, 94, 84, 0.2);
        }

        .main-card h2 { margin-bottom: 10px; font-size: 1.8rem; }
        .main-card p { opacity: 0.9; font-size: 0.9rem; margin-bottom: 25px; }

        .start-btn {
            background: #ffffff;
            color: var(--p);
            border: none;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: 0.3s;
        }
        .start-btn:active { transform: scale(0.95); }

        .filters-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .filter-option {
            background: var(--card);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid rgba(0,0,0,0.05);
            cursor: pointer;
            transition: 0.3s;
        }
        .filter-option:hover { border-color: var(--p); }
        .filter-option i { font-size: 1.8rem; display: block; margin-bottom: 8px; }
        .filter-option span { font-size: 0.85rem; font-weight: bold; color: var(--txt); }

        .status-bar {
            display: flex;
            justify-content: space-around;
            padding: 15px;
            background: var(--card);
            border-radius: 15px;
            font-size: 0.8rem;
            margin-top: 10px;
        }
        .online-dot { color: #2ecc71; font-weight: bold; }
    </style>
</head>
<body class="light-mode">

    <div class="header">
        <div style="display: flex; align-items: center; gap: 10px;">
            <div class="logo-area" style="font-size: 1.5rem;">ğŸ¤</div>
            <h2 style="font-size: 1.2rem;">Stranger Meeting</h2>
        </div>
        <div style="display: flex; gap: 15px;">
            <button class="icon-btn" onclick="toggleTheme()">ğŸŒ“</button>
            <button class="icon-btn" onclick="location.href='profile.html'">ğŸ‘¤</button>
        </div>
    </div>

    <div class="discovery-container">
        <div class="main-card">
            <h2 class="tr" data-key="title">Ø§Ø³ØªÙƒØ´Ù Ø§Ù„Ø¹Ø§Ù„Ù…</h2>
            <p>Ø§Ø¨Ø¯Ø£ Ù…Ø­Ø§Ø¯Ø«Ø© ÙÙŠØ¯ÙŠÙˆ ÙÙˆØ±ÙŠØ© Ù…Ø¹ Ø´Ø®Øµ Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø§Ù„Ø¢Ù†</p>
            <button class="start-btn" onclick="startDiscovery('both')">ğŸ² Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</button>
        </div>

        <h3 style="margin-top: 10px; font-size: 1rem;" class="tr" data-key="interests">ØªØ®ØµÙŠØµ Ø§Ù„Ø¨Ø­Ø«:</h3>

        <div class="filters-grid">
            <div class="filter-option" onclick="startDiscovery('opposite')">
                <i>âœ¨</i>
                <span class="tr" data-key="matchOpposite">Ø§Ù„Ø¬Ù†Ø³ Ø§Ù„Ø¢Ø®Ø±</span>
            </div>
            <div class="filter-option" onclick="startDiscovery('same')">
                <i>ğŸ‘¥</i>
                <span class="tr" data-key="matchSame">Ù†ÙØ³ Ø§Ù„Ø¬Ù†Ø³</span>
            </div>
        </div>

        <div class="status-bar">
            <span>Ø§Ù„Ø®Ø§Ø¯Ù…: <span class="online-dot">Ù…ØªØµÙ„ âœ…</span></span>
            <span>Ø§Ù„Ù…ØªØµÙ„ÙŠÙ† Ø§Ù„Ø¢Ù†: <strong id="onlineCount">...</strong></span>
        </div>
    </div>

    <div style="height: 70px;"></div> <div style="position: fixed; bottom: 0; width: 100%; background: var(--card); display: flex; justify-content: space-around; padding: 10px 0; border-top: 1px solid #ddd; z-index: 100;">
        <button class="icon-btn" style="color: var(--p);">ğŸ </button>
        <button class="icon-btn" onclick="location.href='chat.html'">ğŸ’¬</button>
        <button class="icon-btn" onclick="location.href='profile.html'">âš™ï¸</button>
    </div>

    <script type="module">
        import { auth, db, startDiscovery } from './ui-logic.js';
        import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { collection, query, where, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Ø¬Ø¹Ù„ Ø§Ù„Ø¯Ø§Ù„Ø© Ù…ØªØ§Ø­Ø© Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹ Ù„Ù„Ø£Ø²Ø±Ø§Ø±
        window.startDiscovery = startDiscovery;

        onAuthStateChanged(auth, (user) => {
            if (!user) location.href = "login.html";
        });

        // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØªØµÙ„ÙŠÙ† ÙÙˆØ±ÙŠØ§Ù‹
        const q = query(collection(db, "users"), where("isOnline", "==", true));
        onSnapshot(q, (snapshot) => {
            document.getElementById("onlineCount").innerText = snapshot.size + " Ù…Ø³ØªØ®Ø¯Ù…";
        });
    </script>
</body>
</html>
